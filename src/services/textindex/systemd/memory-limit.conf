# SPDX-FileCopyrightText: 2025 UnionTech Software Technology Co., Ltd.
#
# SPDX-License-Identifier: GPL-3.0-or-later

# Resource accounting and limits for TextIndex service
# Prevents OOM issues when parsing problematic documents

[Service]
# Enable memory accounting (REQUIRED for memory limits to work)
MemoryAccounting=yes

# Soft limit: Triggers memory pressure when exceeded, causing the process to slow down
# but not be killed. This provides graceful degradation.
MemoryHigh=900M

# Hard limit: Maximum memory allowed. If exceeded, the process will be killed by the
# OOM killer. Set higher than MemoryHigh to provide a safety margin.
MemoryMax=1200M

# Optional: Set swap limit to prevent excessive swapping
# MemorySwapMax=100M

# Note: These limits apply to the entire service cgroup, including all child processes.
# Adjust values based on system requirements and testing results.
